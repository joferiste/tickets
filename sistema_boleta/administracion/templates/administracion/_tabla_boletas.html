<!-- _tabla_boletas.html -->
{% for boleta in boletas %}
<tr class="inbox-row {% if not boleta.leido %}unread{% endif %} {% if boleta.estado_validacion == 'procesada' %}processed{% endif %}">
    <td class="col-status">
        <div class="status-indicator">
            {% if boleta.estado_validacion == "sin_imagen" %}
                <span class="status-dot error"></span>
                <span class="status-text">Sin Imagen</span>
            {% elif boleta.estado_validacion == "rechazada" %}
                <span class="status-dot rejected"></span>
                <span class="status-text">Rechazada</span>
            {% elif not boleta.leido %}
                <span class="status-dot unread"></span>
                <span class="status-text">Nuevo</span>
            {% elif boleta.estado_validacion == "procesada" %}
                <span class="status-dot processed"></span>
                <span class="status-text">Procesada</span>
            {% else %}
                <span class="status-dot pending"></span>
                <span class="status-text">Pendiente</span>
            {% endif %}
        </div>
    </td>
    <td class="col-sender">
        <div class="sender-info">
            <div class="sender-avatar">
                {{ boleta.remitente|first|upper }}
            </div>
            <div class="sender-details">
                <div class="sender-name">{{ boleta.remitente|truncatechars:25 }}</div>
                <div class="sender-email">{{ boleta.remitente }}</div>
            </div>
        </div>
    </td>
    <td class="col-subject">
        <div class="subject-content">
            <div class="subject-text">{{ boleta.asunto|default:"(sin asunto)"|truncatechars:40 }}</div>
            {% if boleta.imagen %}
                <span class="attachment-icon">üìé</span>
            {% endif %}
        </div>
    </td>
    <td class="col-date">
        <div class="date-info">
            <div class="date-main">{{ boleta.fecha_recepcion|date:"d/m/Y" }}</div>
            <div class="date-time">{{ boleta.fecha_recepcion|date:"H:i" }}</div>
        </div>
    </td>
    <td class="col-business">
        <div class="business-info">
            {% if boleta.metadata.negocio %}
                <div class="business-detected">
                    <span class="business-name-text">{{ boleta.metadata.negocio|truncatechars:20 }}</span>
                </div>
            {% else %}
                <div class="business-not-detected">
                    <span class="business-icon">‚ùì</span>
                    <span class="business-text">No detectado</span>
                </div>
            {% endif %}
        </div>
    </td>
    <td class="col-actions">
        <div class="action-buttons">
            {% if boleta.estado_validacion == "procesada" %}
                <span class="action-completed">
                    <span class="completed-icon">‚úÖ</span>
                    <span class="completed-text">Completada</span>
                </span>
            {% else %}
                <a href="{% url 'administracion:boleta_detalle' boleta.id %}" class="btn-action btn-view">
                    <span class="action-text">Ver</span>
                </a>
            {% endif %}
        </div>
    </td>
</tr>
{% empty %}
<tr class="empty-row">
    <td colspan="6" class="empty-state">
        <div class="empty-content">
            <div class="empty-icon">üì≠</div>
            <div class="empty-title">No hay boletas en el inbox</div>
            <div class="empty-description">Las boletas recibidas aparecer√°n aqu√≠ cuando lleguen por correo electr√≥nico.</div>
        </div>
    </td>
</tr>
{% endfor %}
</script>
