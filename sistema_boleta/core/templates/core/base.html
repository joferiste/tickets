{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Home{% endblock %}</title>
    <link rel="stylesheet" href="{% static 'core/css/styles.css' %}">  
    {% block extra_css %}{% endblock %}  
    <script src="{% static 'core/js/main.js' %}" defer></script> 
</head>
<body>
    {# Redirigir si no esta autenticado #}
    {% if not user.is_authenticated %}
        <script> window.location.href = "{% url 'login' %}";</script>
    {% endif %}
    <!-- Header -->
    <header class="header">
        <div class="page-title">{% block page_title %}Dashboard{% endblock %}</div>
        <div class="admin-info">
            <!-- Notificaciones -->
            <div class="notifications">
                <button class="notif-btn" type="button" aria-label="Notificaciones">
                    <img src="{% static 'icons/bell.svg' %}" alt="Notificaciones" class="notif-icon">
                    <span class="notif-count">5</span>
                </button>
            
                <div class="notif-dropdown">
                    <div class="notif-header">Notificaciones</div>
                    <div class="notif-item">
                        <strong>Nueva boleta recibida</strong>
                        <span class="notif-time">Hace 5 min</span>
                    </div>
                    <div class="notif-item">
                        <strong>Boleta pendiente de validaci√≥n</strong>
                        <span class="notif-time">Hace 15 min</span>
                    </div>
                    <div class="notif-item">
                        <strong>Boleta aprobada exitosamente</strong>
                        <span class="notif-time">Hace 1 hora</span>
                    </div>
                    <div class="notif-footer">
                        <a href="#" class="notif-view-all">Ver todas</a>
                    </div>
                </div>
            </div>

            <!-- Usuario -->
            <a href="{% url 'logout' %}" class="user-status">
                <span class="user-circle"></span>
                <span class="username">{{ user.username }}</span>
                <span class="logout-text"> Cerrar Sesi√≥n </span>
            </a>
        </div>
    </header>

    <!-- Mensajes Flash -->
    {% if messages %}
        <div class="flash-container">
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }}">
                    {{ message }}
                    <button class="alert-close" type="button" aria-label="Cerrar">&times;</button>
                </div>
            {% endfor %}
        </div>
    {% endif %}

    <!-- Contenedor Principal -->
    <div class="main-container">    
        {% load static actives %}
        
        <!-- Sidebar -->
        <aside class="sidebar">
            <nav class="sidebar-nav">
                <a href="{% url 'home' %}" class="sidebar-link {% active 'home' %}">
                    <span class="sidebar-icon">üìä</span>
                    <span>Dashboard</span>
                </a>
                
                <a href="{% url 'administracion:boletas_sandbox' %}" class="sidebar-link {% active 'boletas_sandbox' %}">
                    <span class="sidebar-icon">‚öôÔ∏è</span>
                    <span>Administraci√≥n</span>
                </a>

                <a href="{% url 'gestion_crud' %}" class="sidebar-link {% active 'gestion_crud' %}">
                    <span class="sidebar-icon">üìã</span>
                    <span>Gesti√≥n CRUD</span>
                </a>
                
                <!-- Submenu Asignaciones -->
                <div class="submenu-container">
                    <button class="submenu-toggle" type="button" data-submenu="asignaciones-submenu">
                        <span class="sidebar-icon">üîó</span>
                        <span>Asignaciones</span>
                        <span class="submenu-arrow">‚ñ∏</span>
                    </button>
                    <div class="submenu" data-submenu-id="asignaciones-submenu">
                        <a href="{% url 'usuarios:usuario_negocio' %}" class="submenu-link {% active 'usuario_negocio' %}">
                            Usuarios a Negocios
                        </a>
                        <a href="{% url 'negocios:negocio_local' %}" class="submenu-link {% active 'negocio_local' %}">
                            Negocios a Locales
                        </a>
                        <a href="{% url 'locales:orden_local' %}" class="submenu-link {% active 'orden_local' %}">
                            Orden de Locales
                        </a>
                    </div>
                </div>  
                
                <a href="{% url 'historiales:dashboard_metricas' %}" class="sidebar-link {% active 'dashboard_metricas' %}">
                    <span class="sidebar-icon">üìä</span>
                    <span>An√°lisis y m√©tricas</span>
                </a>

                <a href="{% url 'reportes:consolidado_ingresos' %}" class="sidebar-link {% active 'consolidado_ingresos' %}">
                    <span class="sidebar-icon">üìà</span>
                    <span>Reportes</span>
                </a>

                <a href="{% url 'configuracion:configuracion_sistema' %}" class="sidebar-link {% active 'configuracion_sistema' %}">
                    <span class="sidebar-icon">üîß</span>
                    <span>Configuraci√≥n</span>
                </a>


            </nav>
        </aside>

        <!-- Contenido Principal -->
        <main class="main-container">
            {% block content %}         
            {% endblock %}  
        </main>  
    </div>

    {% block extra_scripts %}{% endblock %}
</body>
</html>